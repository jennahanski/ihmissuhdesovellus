{% extends "layout.html" %}
{% block adminbar %} 
<li class="nav-item">
    <a class="nav-link btn-admin" href="/game/{{ id }}/edit">Edit</a>
<li class="nav-item">
    <a class="nav-link btn-admin" href="/game/{{ id }}/delete">Delete</a>
{% endblock %}

{% block content %}

<div class="container">
    <div class="row-1">
        <div class="col">
            <h1 class="text-center">{{ name }}</h1>
            <p>Release year: {{ year }}</p>
            <hr>
        </div>
    </div>
    <div class="row">
        <div class="col-8">
            {% if reviews %} 
            <h2>Reviews</h2> 
            <div class="my-3 p-3 bg-white rounded shadow-sm">
                {% for entry in reviews %}
                    <div class="media text-muted pt-3">
                        <div class="media-body pb-3 mb-0 small lh-125 border-bottom border-gray">
                            <div class="d-flex justify-content-between align-items-center w-100">
                                <strong class="review-main">
                                    <a href="/user/{{ entry[0] }}">{{ entry[0] }}:</a>
                                </strong>
                                <p>{{ entry[2] }}/10</p>
                            </div>
                            <span class="d-block">"{{ entry[1] }}"</span>
                        </div>
                    </div>
                {% endfor %}     
            </div> 
        </div>
        <p>
        <div class="col-4 col-avg">
            <h4>Score: {{ avg }} / 10</h4>
            {% endif %}
            {% if session.user_id %}
            {% if not favorite %}
            <form action="/game/{{ id }}" method="POST">
                <label for="submit">
                Add to favorites:
                </label>
                <button class="btn btn-fav" type="submit">Add</button>
                <input type="hidden" name="fav" value="1">
                <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
            </form>
            {% else %}
            <form action="/game/{{ id }}" method="POST">
                <label for="submit">
                Remove from favorites:
                </label>
                <button class="btn btn-fav" type="submit">Remove</button>
                <input type="hidden" name="fav" value="0">
                <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
            </form>
            {% endif %}
            {% endif %}
        </div>
    </div>
    <p>
    <hr>
    <div class="row">
        <div class="col">
            {% if session.user_id %} 
            <h3>{{ message }}</h3>
            <form action="/review" method="POST">
                Rating:
                <select class="rev-select" name="grade">
                    <option value="1">1
                    <option value="2">2
                    <option value="3">3
                    <option value="4">4
                    <option value="5">5
                    <option value="6">6
                    <option value="7">7
                    <option value="8">8
                    <option value="9">9
                    <option value="10">10
                </select>
                <p>
                Comment:<br>
                <textarea name="comment" rows="4" cols="30" maxlength="1000"></textarea>
                <p><input class="btn btn-send" type="submit" value="Send">
                <input type="hidden" name="game_id" value="{{ id }}">
                <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
            </form>
        </div>
        <div class="col">
            Add the game to your list:
            <form action="/game/{{ id }}" method="POST">
                <select name="list">
                    <option value="0">To Play
                    <option value="1">Played games
                </select>
                <input class="btn btn-send" type="submit" value="Send">
                <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
            </form>
            {% endif %} 
        </div>
        <div class="col">
            <br>
            {% if tags %}
            <b>Tags:</b>
            {% endif %}
            <p>
            {% for tag in tags %} 
                {{ tag[0] }}  
                <span class="badge badge-tag badge-pill">{{ tag[1] }}</span>
            {% endfor %}
            <form action="/{{ id }}/add_tag">
                <input class="btn btn-send" type="submit" value="Add tags">
            </form>
        </div>
    </div>
</div>
<p>
{% endblock %}